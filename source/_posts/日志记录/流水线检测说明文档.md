---
title:  流水线检测说明文档
toc: true
date: 2021-11-07 01:31:20
tags:
categories:
---


## 1 设备状态和控制

### 1.1 设备状态显示

#### 图片

- 说明：显示当前机械臂

#### 相机设备信息

- 说明：标识当前产品序列号和状态信息

### 1.2 机械臂参数控制

#### 启动

- 说明：控制相机采集和机械臂的开关

#### 输出端口

- 说明：机械臂连接的串口

#### 机械臂初始化

- 说明：触发机械臂的位置重新校准功能
- 备注：关节电机过紧会导致无法复位

#### 距离地面高度

- 说明：待夹取和放置物体以机械臂底座参考下的高度
- 单位：mm

#### 原点坐标

- 说明：复位和初态的坐标位置
- 坐标系：机械臂坐标系
- 单位：mm

#### 目标坐标

- 说明：抓取物体后放置的坐标位置
- 坐标系：机械臂坐标系
- 单位：mm

#### 行数、列数、间隔

- 说明：在目标坐标下以棋盘格放置方式放置抓取物体
- 间隔：棋盘格方格大小单位mm
- 坐标系：机械臂坐标系

#### 释放角度

- 说明：机械臂夹取装置旋转补偿角度
- 单位：角度值

### 1.3 目标检测参数控制

#### 角度步长

- 说明：检测目标角度的划分粒度
- 单位：角度

#### 角度范围

- 说明：检测目标的角度范围
- 单位：角度

#### 起始角度

- 说明： 角度计算时的基准角度
- 单位：角度

### 金字塔层级

- 说明：对图像的采样级数推荐(0~3)
- 备注：采样层数越高，速度越快但精度可能下降

#### 匹配程度阈值

- 说明：目标和模板匹配程度的得分（0~1）
- 备注：得分越高匹配程度越高，但相对检出率会降低



### 1.4 相机参数控制

#### 增益

- 范围 0~16.9
- 说明：在曝光时间不变的情况下增加画面亮度

#### 曝光时间

- 范围 0~10000
- 说明：通过控制每张图片的曝光时间控制画面亮度



### 1.5 坐标系变换参数

#### 相机距离

- 说明：相机到待检测平面的固定距离
- 单位：mm

#### 相机焦距

- 说明：相机的内部参数相机焦距
- 单位：mm

#### 单位像素物理尺寸

- 说明: 相机的内部参数像元尺寸
- 单位：mm

#### 图片宽度、高度

- 说明：相机采图获得图片的高度和宽度

#### 原点坐标

- 说明：相机坐标系和机械臂坐标系的偏差补偿
- 备注：以相机坐标系为准平移到机械臂坐标系原点位置

#### 旋转角度

- 说明：相机坐标系到机械臂坐标系的旋转角度
- 单位：角度

#### 内参矩阵

- 说明：更加精确的相机参数，需要进行标定处理

## 2 模板制作

### 2.1 制作

流水线检测目标依赖于模板的制作，在实现目标检测之前我们需要手动进行模板的构建

1. 点击左侧菜单进入模板页面
2. **选择用于制作模板的相机设备**列表中选择设备
3. 点击**添加模板+**按钮开始制作模板
4. 在弹出的窗口中，框选目标(最好在单一背景下框选处目标)，如果意外误触可通过按键盘ESC退出制作
5. 选择完成后按下键盘上ENTER键开始生成
6. 接下来程序会在后台进行扣取目标并生成模板，此时只需要等待一段时间
7. 模板生成后会出现在下侧列表中

### 2.2 编辑模板

针对已经制作的模板我们可以对他进行删除操作，具体操作为点击模板下方**更多** -> **删除**即可删除已经创建的模板

### 3  窗口设置

我们可以点击页面最右上角的按钮，将软件串口在最小化、全屏和小窗之间进行切换



## 3 系统使用

### 3.1 标定

### 机械臂自身标定

在控制面版，在选择机械臂的**输出端口**后，点击机械臂初始化，对机械臂进行初始化复位。

备注：开机后需要进行标定且对于机械臂需要处于初始位置，且关节电机不能过紧。

### 相机和机械臂联合标定

为更好贴合机械为回复的初始位置和相机坐标系间的补偿需要对进行联合标定，此标定仅需一次进行后续记录参数即可使用。

在绑定**输出端口**后点击**开启**按钮打开摄像头，尽快点击机械臂补偿标定进入机械臂的标定状态，该状态需要搭配一个红色铅锤和深色背景防止干扰

### 3.2 使用

在制作模板之后，选择机械臂连接的**输出端口**并打开控制面板下的**启动**按钮即可开始进行检测和抓取操作
