---
title: 串口开发
toc: true
date: 2021-09-17 22:26:32
---

## 串口异常分析

1. 如果串口端口不存在，则try-catch能够获取“系统找不到指定的文件”文件异常。

2. 如果串口端口没有和实际的串口连接，则try-catch能够获取“设备没有连接”的异常。

3. 如果在电脑之上连接一个串口线，则用此函数打开对应的端口（如COM4 ）就不会出现以上两个异常。
   1. 如果不在此串口下挂一个设备，则对端口进行读写操作的时候会出现异常，如读串口数据时会在read函数这里卡住。
   2. 但如果在串口下挂一个设备如51单片机学习板则此函数会返回并读出一定的数据回来（虽不一定正确）。
   3. 如果将挂在串口下的设备开启，try-catch会捕获“连接到系统上的设备没有发挥作用”或者是read函数又开始不能返回。



## Boost 串口通讯

### 基本流程

1. 创建IO调度器
2. 利用调度器创建串口对象
3. 打开串口
4. 设置相关串口参数（**一定要在串口开启后操作**）
5. 进行读写操作

### 同步和异步

同步可以认为是阻塞式，调度后等待任务完成后在执行下一项

异步可以认为是多个线路并行处理，调度后继续执行下一项，等子线路完成后回调处理内容

## 字符串和字符数组的转换

char类型占8位1字节，的空间大小，不同编译器对char的实现不同有的默认是signed char 有的是unsigned char 从8位补码的角度理解，两种是对于同样数据的不同解释。即使中间字符串或者字符数组用singned char表示后期依然可以通过unsigined char的指针的到正确的结果。其原因在于两者所占内存空间的大小是一样的。

## Todo

1. 同步读取，出现异常一直处于阻塞状态，添加计时器计时舍弃

## 参考资料

[[0921 实践]C++ boost::asio::serial_port 串口通信类 使用 封装 笔记](https://www.xuebuyuan.com/1363689.html)